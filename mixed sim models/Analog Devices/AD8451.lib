* AD8451 SPICE Macro-model
* Description: Precision Analog Front-End and Controller for Battery Tests/Formation Systems
* Generic Desc: Precision analog front-end and controller for testing and monitoring battery cells
* Developed by ABriones
* Revision History: 03-28-14, Rev. 0
* Copyright 2014 by Analog Devices
*
* Refer to http://www.analog.com/Analog_Root/static/techSupport/designTools/spiceModels/license/spice_general.html for License Statement. Use of this model
* indicates your acceptance with the terms and provisions in the License Statement.
*
* BEGIN Notes:
* Parameters Not Modeled:
*	Temperature Effects
*	Line/Load Regulation
*	Short-circuit Current
*	PSRR
*	Current Noise Density
*	Slew Rate
*	Capacitive Load Drive
*	Mode Switching Time
* END Notes

*		1     2      3    4      5      6     7     8      9    10    11    12    13      14     15      16      17     18     19     20     21      22      23     24     25     26        27         28        29           30           31     32     33     34     35       36       37         38      39        40      41      42       43     44      45       46      47      48     49       50         51      52      53     54       55    56        57      58      59       60        61     62     63     64     65     66     67      68        69       70       71           72      73        74          75        76          77         78     79     80
.SUBCKT AD8451  ISVP RGP NC NC1 NC2 NC3 NC4 NC5 NC6 NC7 NC8 NC9 NC10 NC11 NC12 NC13 NC14 NC15 RGN ISVN NC16 BVPS NC17 BVP NC18 VREF BVREFH AGND BVREFL BVREFLS NC19 BVN NC20 NC21 BVNS AVEE BVMEA AVCC MODE NC22 NC23 VREF1 NC24 NC25 DGND NC26 DVCC NC27 VSET VSETBF VVP0 NC28 VVE0 VVE1 NC29 VINT AVCC1 VCLN VCTRL VCLP AVEE1 VINT NC30 IVE1 IVE0 NC31 ISET ISREFB NC32 AVCC2 ISMEA AVEE2 VREF2 ISREFH AGND1 ISREFL ISREFLS NC33 NC34 NC35 
	
V75 0 84 dc 27 ac 0 0
V74 105 0 dc 27 ac 0 0
D86 152 153 DIODE
D85 159 152 DIODE
D84 158 159 DIODE
D83 157 158 DIODE
D82 156 157 DIODE
D81 155 156 DIODE
D80 BVN 155 DIODE
D79 BVP 79 DIODE
D78 79 78 DIODE
D77 78 76 DIODE
D76 76 75 DIODE
D75 75 160 DIODE
D74 160 154 DIODE
D73 154 80 DIODE
D102 137 BVP DIODE
D101 138 137 DIODE
D100 139 138 DIODE
D99 140 139 DIODE
D98 141 140 DIODE
D97 142 141 DIODE
D96 143 142 DIODE
D95 144 143 DIODE
D94 145 144 DIODE
D93 146 145 DIODE
D92 147 146 DIODE
D91 148 147 DIODE
D90 149 148 DIODE
D89 150 149 DIODE
D88 151 150 DIODE
D87 153 151 DIODE
D72 80 101 DIODE
D71 101 102 DIODE
D70 102 120 DIODE
D69 120 122 DIODE
D68 122 123 DIODE
D67 123 124 DIODE
D66 124 125 DIODE
D65 125 127 DIODE
D64 127 128 DIODE
D63 128 129 DIODE
D62 129 130 DIODE
D61 130 131 DIODE
D60 131 133 DIODE
D59 133 135 DIODE
D48 135 136 DIODE
D47 136 BVN DIODE
V101 34 AVEEX_5 dc 1 ac 0 0
D58 34 VCTRL_3 DIODE
D57 VCTRL_3 VCTRL_2 DIODE
V100 AVCCX_5 28 dc 1 ac 0 0
D56 VCTRL_3 VCTRL_2 DIODE
D55 VCTRL_2 28 DIODE
V84 23 0 dc 0 ac 0 0
R57 26 23 0.0166 
xV83 0 26 BVN 24 IC_V_SourceV83
.SUBCKT IC_V_SourceV83 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 1
.ends
D53 106 134 DIODE
V80 AVCCX_5 134 dc 1.5 ac 0 0
D54 132 106 DIODE
V81 132 AVEEX_5 dc 1.5 ac 0 0
R98 BVPS BVP 0.0001 
R91 BVNS BVN 0.0001 
R93 24 107 100000 
R100 BVP non_inv 100000 
R97 BVN BVP 200000 
R99 BVP 0 90000 
R92 BVN 0 90000 
D51 BVP 108 DIODE
V78 108 0 dc 27 ac 0 0
D52 81 BVP DIODE
V79 0 81 dc 27 ac 0 0
D45 BVN 105 DIODE
D46 84 BVN DIODE
R104 BVREFL BVREFLS 0.0001 
V82 106 BVMEA dc 0.0005 ac 0 0
D49 126 AVCCX_5 DIODE
D50 AVEEX_5 126 DIODE
gI32 0 106 126 0 0.02
R106 0 106 40 
C10 0 106 1e-009
R105 126 0 10000000 
C9 126 0 9e-008
gI31 0 126 non_inv 107 1
R102 121 BVREFL 100 
R103 BVREFH 121 50000 
R101 non_inv 121 79900 
R94 107 106 80000 
V66 59 0 dc 0 ac 0 0
R85 56 59 0.0166 
xV65 0 56 31 10 IC_V_SourceV65
.SUBCKT IC_V_SourceV65 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
V56 54 0 dc 0 ac 0 0
R80 51 54 0.0166 
xV55 0 51 39 2 IC_V_SourceV55
.SUBCKT IC_V_SourceV55 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
D44 VINT 50 DIODE
V72 AVCCX_5 50 dc 1 ac 0 0
D43 49 VINT DIODE
V73 49 AVEEX_5 dc 1.5 ac 0 0
I30 CV_IN- 0 dc 5e-009 ac 0 0
D42 CV_IN- 45 DIODE
V70 AVCCX_5 45 dc 1.8 ac 0 0
D41 44 CV_IN- DIODE
V71 44 AVEEX_5 dc 1.5 ac 0 0
I25 CC_IN- 0 dc 5e-009 ac 0 0
D34 CC_IN- 43 DIODE
V60 AVCCX_5 43 dc 1.8 ac 0 0
D35 42 CC_IN- DIODE
V61 42 AVEEX_5 dc 1.5 ac 0 0
I21 ISET 0 dc 5e-009 ac 0 0
D29 ISET 41 DIODE
V52 AVCCX_5 41 dc 1.8 ac 0 0
D30 40 ISET DIODE
V53 40 AVEEX_5 dc 1.5 ac 0 0
V54 ISET 39 dc 0.00015 ac 0 0
I26 CV_IN+ 0 dc 5e-009 ac 0 0
D36 CV_IN+ 38 DIODE
V62 AVCCX_5 38 dc 1.8 ac 0 0
D37 83 CV_IN+ DIODE
V63 83 AVEEX_5 dc 1.5 ac 0 0
V64 CV_IN+ 31 dc 0.00015 ac 0 0
R89 16 AVEEX_5 10 
R84 6 AVEEX_5 10 
R88 AVCCX_5 68 10000 
R87 29 20 1  
R83 AVCCX_5 8 10000 
R82 74 9 1 
V58 71 AVEEX_5 dc 1.3 ac 0 0
V57 70 AVEEX_5 dc 2 ac 0 0
V68 73 AVEEX_5 dc 1.3 ac 0 0
V67 72 AVEEX_5 dc 2 ac 0 0
eV69 29 0 15 0 1
eV59 74 0 5 0 1
R90 VINT VINT1 0.01 
C8 0 15 4.7e-008
C7 0 5 4.7e-008
D39 73 15 DIODE
D38 15 72 DIODE
D32 71 5 DIODE
D31 5 70 DIODE
I29 AVCCX_5 VINT dc 0.0011 ac 0 0
I28 AVCCX_5 68 dc 0.0001 ac 0 0
D40 68 VINT DIODE
Q7 AVEEX_5 68 VINT PNP
Q6 68 20 16 NPN
R86 0 15 3161000 
gI27 0 15 10 CV_IN- 1
I24 AVCCX_5 VINT dc 0.0011 ac 0 0
I23 AVCCX_5 8 dc 0.0001 ac 0 0
D33 8 VINT DIODE
Q5 AVEEX_5 8 VINT PNP
Q4 8 9 6 NPN
R81 0 5 3161000 
gI22 0 5 2 CC_IN- 1
R79 RGN RGP 1667 
D28 67 ISMEA DIODE
V51 67 AVEEX_5 dc 1.5 ac 0 0
D27 ISMEA 66 DIODE
V50 AVCCX_5 66 dc 1.2 ac 0 0
I13 PGIA_IN+ 0 dc 2e-009 ac 0 0
I14 PGIA_IN+ 0 dc 2.8e-008 ac 0 0
I9 PGIA_IN- 0 dc 3e-008 ac 0 0
R53 PGIA_IN- PGIA_IN+ 150000000000 
R61 PGIA_IN+ 0 150000000000 
R54 PGIA_IN- 0 150000000000 
D18 65 PGIA_IN+ DIODE
V40 65 AVEEX_5 dc 2.3 ac 0 0
D17 PGIA_IN+ 64 DIODE
V39 AVCCX_5 64 dc 2.4 ac 0 0
D11 PGIA_IN- 63 DIODE
V31 AVCCX_5 63 dc 2.4 ac 0 0
D12 62 PGIA_IN- DIODE
V32 62 AVEEX_5 dc 2.3 ac 0 0
eV45 58 0 48 0 1
C4 55 58 8.5e-012
I16 52 55 dc 3e-005 ac 0 0
R63 61 0 0.0166 
V43 60 0 dc 0 ac 0 0
xV42 61 60 57 46 IC_V_SourceV42
.SUBCKT IC_V_SourceV42 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 3.5
.ends
D20 57 AVCCX_5 DIODE
D19 AVEEX_5 57 DIODE
R65 RGP 58 10000 
D21 48 AVCCX_5 DIODE
D22 AVEEX_5 48 DIODE
V46 52 AVCCX_5 dc 20 ac 0 0
R62 57 0 10000000 
gI15 0 57 37 57 1
eV47 21 0 48 0 1
R66 55 52 1000000 
Q3 55 47 RGP NPN
gI17 0 48 52 55 1
R67 48 0 1000000 
eV44 47 0 46 0 1
V41 PGIA_IN+ 37 dc 0.0001 ac 0 0
eV36 13 0 4 0 1
D26 30 AVCCX_5 DIODE
D25 AVEEX_5 30 DIODE
R71 ISREFLS_1 ISREFL 0.0001 
D24 AVEEX_5 subtractor_1 DIODE
D23 subtractor_1 AVCCX_5 DIODE
C3 11 13 8.5e-012
I11 7 11 dc 3e-005 ac 0 0
R56 36 0 0.0166 
V34 35 0 dc 0 ac 0 0
xV33 36 35 12 1 IC_V_SourceV33
.SUBCKT IC_V_SourceV33 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 3.5
.ends
R76 33 0 0.0166 
V49 32 0 dc 0 ac 0 0
xV48 33 32 subtractor_1 27 IC_V_SourceV48
.SUBCKT IC_V_SourceV48 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 105
.ends
C6 ISMEA 0 2.65e-010
C5 30 0 7e-008
R78 ISMEA 0 500 
R77 30 0 10000000000 
gI20 0 ISMEA 30 0 0.002
gI19 0 30 27 ISMEA 1
L1 21 17 0.00038
D14 12 AVCCX_5 DIODE
D13 AVEEX_5 12 DIODE
R73 25 ISREFH 100000 
R72 25 ISREFL 806 
R70 18 25 19200 
R75 subtractor_1 0 10000000 
R74 14 subtractor_1 20000 
gI18 0 subtractor_1 18 14 1
R69 17 18 10004.66 
R68 19 14 10000 
R58 RGN 13 10000 
D15 4 AVCCX_5 DIODE
D16 AVEEX_5 4 DIODE
V37 7 AVCCX_5 dc 20 ac 0 0
R55 12 0 10000000 
gI10 0 12 PGIA_IN- 12 1
eV38 19 0 4 0 1
R59 11 7 1000000 
Q2 11 3 RGN NPN
gI12 0 4 7 11 1
R60 4 0 1000000 
eV35 3 0 1 0 1
D10 98 95 DIODE
D9 95 97 DIODE
V28 98 0 dc -7 ac 0 0
V29 97 0 dc 7 ac 0 0
Q1 93 96 0 PNP
eV27 96 0 95 0 1
R51 104 95 1000 
gI8 104 95 90 92 1
R52 DVCCX 93 1000 
eV23 94 0 MODE 0 1
V25 91 0 dc 1.613 ac 0 0
R50 89 22 10000 
R49 94 89 2400 
eV30 22 0 93 0 1
eV26 92 0 91 0 1
eV24 90 0 89 0 1
xS3 CV_IN+ VSET VVP0 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xS2 CV_IN- VVE1 VVE0 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xS1 CC_IN- IVE1 IVE0 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xSVN ISVN PGIA_IN- PGIA_IN+ 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xSVP ISVP PGIA_IN+ PGIA_IN- 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
R48 82 VSETBF 1 
D8 110 82 DIODE
V22 110 AVEEX_5 dc 1.5 ac 0 0
D7 82 109 DIODE
V21 AVCCX_5 109 dc 1.5 ac 0 0
V17 VSET 114 dc 0.00015 ac 0 0
V19 86 0 dc 0 ac 0 0
R46 113 86 0.0166 
xV18 0 113 114 103 IC_V_SourceV18
.SUBCKT IC_V_SourceV18 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
D5 VSET 112 DIODE
V15 AVCCX_5 112 dc 1.8 ac 0 0
D6 111 VSET DIODE
V16 111 AVEEX_5 dc 1.5 ac 0 0
I6 VSET 0 dc 5e-009 ac 0 0
eV20 82 0 118 0 1
C2 0 118 4.77465e-008
R47 0 118 3161177.66 
gI7 0 118 103 82 1
R45 VCTRL VCTRL_1 1 
D4 100 VCTRL DIODE
V14 VCTRL_3 100 dc 0.6 ac 0 0
D3 VCTRL 99 DIODE
V13 99 VCTRL_2 dc 0.6 ac 0 0
V9 VINT 88 dc 0.00015 ac 0 0
V11 87 0 dc 0 ac 0 0
R43 85 87 0.0166 
xV10 0 85 88 115 IC_V_SourceV10
.SUBCKT IC_V_SourceV10 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
D1 VINT 117 DIODE
V7 AVCCX_5 117 dc 1.8 ac 0 0
D2 116 VINT DIODE
V8 116 AVEEX_5 dc 1.5 ac 0 0
eV12 VCTRL 0 119 0 1
C1 0 119 4.77465e-008
R44 0 119 3161177.66 
gI5 0 119 115 VCTRL 1
R42 NC34 NC35 0.0001 
R38 NC30 NC31 0.0001 
R39 NC31 NC32 0.0001 
R40 NC32 NC33 0.0001 
R41 NC33 NC34 0.0001 
R33 NC24 NC25 0.0001 
R34 NC25 NC26 0.0001 
R35 NC26 NC27 0.0001 
R36 NC27 NC28 0.0001 
R37 NC28 NC29 0.0001 
R29 NC20 NC21 0.0001 
R30 NC21 NC22 0.0001 
R31 NC22 NC23 0.0001 
R32 NC23 NC24 0.0001 
R24 NC14 NC15 0.0001 
R25 NC15 NC16 0.0001 
R26 NC16 NC17 0.0001 
R27 NC17 NC18 0.0001 
R28 NC18 NC19 0.0001 
R20 NC10 NC11 0.0001 
R21 NC11 NC12 0.0001 
R22 NC12 NC13 0.0001 
R23 NC13 NC14 0.0001 
R15 NC4 NC5 0.0001 
R16 NC5 NC6 0.0001 
R17 NC6 NC7 0.0001 
R18 NC7 NC8 0.0001 
R19 NC8 NC9 0.0001 
R11 NC NC1 0.0001 
R12 NC1 NC2 0.0001 
R13 NC2 NC3 0.0001 
R14 NC3 NC4 0.0001 
R7 DGND 0 0.0001 
R8 AVEE2 AVEE1 0.0001 
R9 AVEE1 AVEE 0.0001 
R4 AVCC2 AVCC1 0.0001 
R5 AVCC1 AVCC 0.0001 
R10 AGND 0 0.0001 
R6 AGND1 0 0.0001 
I3 DVCC 0 dc 4e-005 ac 0 0
eV5 DVCCX 0 DVCC 0 1
I4 0 AVEE dc 0.0065 ac 0 0
I2 AVCC 0 dc 0.007 ac 0 0
eV6 AVEEX_5 0 AVEE 0 1
eV4 AVCCX_5 0 AVCC 0 1
I1 VREF 0 dc 0.01 ac 0 0
R3 VREF1 VREF2 0.0001 
R2 VREF VREF1 0.0001 
V3 69 0 dc 0 ac 0 0
R1 53 69 0.0166 
xV2 0 53 77 VREF IC_V_SourceV2
.SUBCKT IC_V_SourceV2 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 100
.ends
V1 77 0 dc 2.5 ac 0 0

.MODEL NPN NPN

.MODEL NPN1 NPN
+ (
+  Level=1
+ )
 
.model PNP PNP

.subckt VC_SPDT__SWITCH__1 inA outA1 outA2 ctrlp ctrln Params: Von=1 Voff=1 Ron=1 Roff=1
s1 inA outA1 ctrlp ctrln sw1
s2 inA outA2 ctrlp ctrln sw2

.model sw1 vswitch(Ron={Ron} Roff={Roff} Von={Von} Voff={Voff})
.model sw2 vswitch(Ron={Ron} Roff={Roff} Von={Voff} Voff={Von})

.ends

.model DIODE  D

.ENDS AD8451
