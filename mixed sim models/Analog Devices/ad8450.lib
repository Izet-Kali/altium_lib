* AD8450 SPICE Macro-model
* Description: Precision Analog Front-End and Controller for Battery Tests/Formation Systems
* Generic Desc: Precision analog front-end and controller for testing and monitoring battery cells
* Developed by: NJ PRB
* Revision History: 01-23-14, Rev. 0
* Copyright 2014 by Analog Devices.
* 
* Refer to http://www.analog.com/Analog_Root/static/techSupport/designTools/spiceModels/license/spice_general.html for License Statement. Use of this model
* indicates your acceptance with the terms and provisions in the License Statement.
*
* BEGIN Notes:
* Parameters modeled include: 
* 
*
* 
* Not Modeled: Temperature effects
* END Notes

*		1    2   3     4     5      6     7      8     9    10   11   12    13     14    15    16     17    18  19   20   21    22   23   24   25   26   27     28    29     30     31   32   33   34   35    36   37    38   39   40   41   42    43   44   45   46    47  48  49    50    51  52   53   54  55   56   57    58   59    60   61    62   63   64   65  66   67   68   69   70    71    72    73    74     75    76      77     78   79  80
.SUBCKT AD8450 ISVP RGP RGPS ISGP0 ISGP0S ISGP1 ISGP1S ISGP2 ISGP3 RFBP RFBN ISGN3 ISGN2 ISGN1S ISGN1 ISGN0S ISGN0 RGNS RGN ISVN BVP3S BVP3 BVP2 BVP1 BVP0 VREF BVREFH AGND BVREFL BVREFLS BVN0 BVN1 BVN2 BVN3 BVN3S AVEE BVMEA AVCC MODE OVPS OVPR VREF1 OCPR OCPS DGND FAULT DVCC NC VSET VSETBF VVP0 NC1 VVE0 VVE1 NC2 VINT AVCC1 VCLN VCTRL VCLP AVEE1 VINT1 NC3 IVE1 IVE0 NC4 ISET OAVO OAVN AVCC2 ISMEA AVEE2 VREF2 ISREFH AGND1 ISREFL ISREFLS OAVP IMAX CSH 

V22 AVCCX 76 dc 3 ac 0 0
V20 AVCCX 75 dc 3 ac 0 0
V19 AVCCX 62 dc 3 ac 0 0
V8 AVCCX 61 dc 3 ac 0 0
V75 98 0 dc -7 ac 0 0
V3 60 AVEEX dc 1.5 ac 0 0
V1 AVCCX 59 dc 1.5 ac 0 0
R88 32 AVEEX 10
R87 35 AVEEX 10
R86 AVCCX 57 10000
R85 24 30 1 
R84 AVCCX 46 10000 
R83 36 52 1
V87 14 AVEEX dc 1.3 ac 0 0
V33 18 AVEEX dc 2 ac 0 0
V32 7 AVEEX dc 1.3 ac 0 0
V31 11 AVEEX dc 2 ac 0 0
EV30 24 0 55 0 1
EV23 36 0 23 0 1
V21 PGIA_IN+ 200 dc 0.0001 ac 0 0
V29 44 0 dc 0 ac 0 0
R76 NC NC1 0.0001
R82 NC1 NC2 0.0001
R78 NC2 NC3 0.0001
R77 NC3 NC4 0.0001
D69 AVEEX OCPR DIODE
D68 OCPR 61 DIODE
D67 AVEEX OCPS DIODE
D66 OCPS 62 DIODE
D65 AVEEX OVPR DIODE
D64 OVPR 76 DIODE
D63 AVEEX OVPS DIODE
D62 OVPS 75 DIODE
D28 0 71 DIODE
D27 71 DVCCX DIODE
R58 VINT VINT1 0.001
EV18 15 0 19 0 1
EV16 9 0 10 0 1
D61 20 AVCCX DIODE
D60 AVEEX 20 DIODE
R80 RGNS RGN 0.0001
R79 RGPS RGP 0.0001
R35 ISREFLS ISREFL 0.0001
R34 ISGN1 ISGN1S 0.0001
R33 ISGN0 ISGN0S 0.0001 
R99 ISGP1 ISGP1S 0.0001
R30 ISGP0 ISGP0S 0.0001
D30 AVEEX subtractor DIODE
D29 subtractor AVCCX DIODE
D8 13 PGIA_IN- DIODE
VINN_HRN_PGIA 13 AVEEX dc 2 ac 0 0
D7 PGIA_IN- 12 DIODE
VINN_HRP_PGIA AVCCX 12 dc 2 ac 0 0
D4 4 PGIA_IN+ DIODE
VINP_HRN_PGIA 4 AVEEX dc 2 ac 0 0
D3 PGIA_IN+ 3 DIODE
VINP_HRP_PGIA AVCCX 3 dc 2 ac 0 0
RCMINN_PGIA 0 PGIA_IN- 100000000000 
RCMINP_PGIA PGIA_IN+ 0 100000000000
RDIN_PGIA PGIA_IN+ PGIA_IN- 100000000000
C2 2 9 7.5e-012
C1 21 15 7.5e-012
I11 28 2 dc 3e-005 ac 0 0
I5 29 21 dc 3e-005 ac 0 0
R24 45 0 0.0166 
xV28 45 44 17 38 IC_V_SourceV28
.SUBCKT IC_V_SourceV28 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 3.95
.ends
R23 42 0 0.0166
V27 41 0 dc 0 ac 0 0
xV26 42 41 31 43 IC_V_SourceV26
.SUBCKT IC_V_SourceV26 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 3.95
.ends
R22 40 0 0.0166
V25 39 0 dc 0 ac 0 0
xV24 40 39 subtractor 34 IC_V_SourceV24
.SUBCKT IC_V_SourceV24 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 105
.ends
C6 ISMEA 0 2.65e-010
C5 20 0 7e-008
R21 ISMEA 0 500
R15 20 0 10000000000
GI9 0 ISMEA 20 0 0.002
GI2 0 20 34 ISMEA 1
L1 RFBP 8 0.00236262
D12 17 AVCCX DIODE
D11 AVEEX 17 DIODE
RG_26 ISGN0 ISGP0 1667
RG_66 ISGN1 ISGP1 625
RG_133 ISGN2 ISGP2 305
D2 31 AVCCX DIODE
D1 AVEEX 31 DIODE
R18 5 ISREFH 100000
R17 5 ISREFL 806 
R16 16 5 19200
R20 subtractor 0 10000000
R19 6 subtractor 20000
GI8 0 subtractor 16 6 1
R11 8 16 10002.029
R10 RFBN 6 10000 
R9 RGN 15 10000
D10 19 AVCCX DIODE
D9 AVEEX 19 DIODE
V15 29 AVCCX dc 20 ac 0 0
R7 17 0 10000000
GI4 0 17 PGIA_IN- 17 1
EV5 RFBN 0 19 0 1
R6 21 29 1000000
Q1 21 26 RGN NPN1
GI3 0 19 29 21 1
R5 19 0 1000000
EV4 26 0 38 0 1
RG_200 ISGN3 ISGP3 202
R1 RGP 9 10000
D6 10 AVCCX DIODE
D5 AVEEX 10 DIODE
V11 28 AVCCX dc 20 ac 0 0
R8 31 0 10000000
GI7 0 31 200 31 1
EV10 RFBP 0 10 0 1
R4 2 28 1000000
Q2 2 1 RGP NPN1
GI6 0 10 28 2 1
R3 10 0 1000000  
EV9 1 0 43 0 1
D24 7 55 DIODE
D23 55 11 DIODE
C7 0 55 1.2e-007
C4 0 23 1.2e-007
D22 14 23 DIODE
D21 23 18 DIODE
I16 AVCCX VINT dc 0.0011 ac 0 0
I15 AVCCX 57 dc 0.0001 ac 0 0
D20 57 VINT DIODE
Q6 AVEEX 57 VINT PNP
Q5 57 30 32 NPN
R12 0 55 100000000
GI14 0 55 CV_IN+ CV_IN- 1
I13 AVCCX VINT dc 0.0011 ac 0 0
I12 AVCCX 46 dc 0.0001 ac 0 0
D19 46 VINT DIODE
Q4 AVEEX 46 VINT PNP
Q3 46 52 35 NPN
R2 0 23 100000000
GI10 0 23 ISET CC_IN- 1
D41 108 82 DIODE
V54 108 AVEEX dc 1.5 ac 0 0
D40 82 107 DIODE
V51 AVCCX 107 dc 1.5 ac 0 0
V50 CSH 105 dc 0.00015 ac 0 0
V63 84 0 dc 0 ac 0 0
R62 83 84 0.0166
xV62 0 83 105 79 IC_V_SourceV62
.SUBCKT IC_V_SourceV62 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
D39 CSH 102 DIODE
V49 AVCCX 102 dc 1.8 ac 0 0
D38 101 CSH DIODE
V48 101 AVEEX dc 1.5 ac 0 0
EV43 IMAX 0 82 0 1
C9 0 82 4.77465e-008
R38 0 82 3161177.66
GI30 0 82 79 IMAX 1
V76 VSET 114 dc 0.00015 ac 0 0
V67 86 0 dc 0 ac 0 0
R63 113 86 0.0166
xV66 0 113 114 103 IC_V_SourceV66
.SUBCKT IC_V_SourceV66 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
D47 VSET 112 DIODE
V65 AVCCX 112 dc 1.8 ac 0 0
D44 111 VSET DIODE
V64 111 AVEEX dc 1.5 ac 0 0
I33 VSET 0 dc 5e-009 ac 0 0
D43 110 118 DIODE
V61 110 AVEEX dc 1.5 ac 0 0
D42 118 109 DIODE
V60 AVCCX 109 dc 1.5 ac 0 0
EV44 VSETBF 0 118 0 1
C10 0 118 4.77465e-008
R39 0 118 3161177.66
GI31 0 118 103 VSETBF 1
R81 DGND 0 0.0001
R74 AVEE2 AVEE1 0.0001
R73 AVEE1 AVEE 0.0001 
R72 AVCC2 AVCC1 0.0001 
R71 AVCC1 AVCC 0.0001
R70 AGND1 0 0.0001
R68 AGND 0 0.0001 
I28 DVCC 0 dc 4e-005 ac 0 0
EV55 DVCCX 0 DVCC 0 1
I27 0 AVEE dc 0.0065 ac 0 0
I26 AVCC 0 dc 0.007 ac 0 0
EV53 AVEEX 0 AVEE 0 1
EV52 AVCCX 0 AVCC 0 1
R57 BVP3S BVP3 0.0001 
R56 BVN3S BVN3 0.0001
R55 BVREFL BVREFLS 0.0001
D57 106 AVCCX DIODE
D56 AVEEX 106 DIODE
V86 106 BVMEA dc 0.0005 ac 0 0
D55 126 AVCCX DIODE
D54 AVEEX 126 DIODE
GI35 0 106 126 0 0.02
R54 0 106 40
C16 0 106 1e-009
R53 126 0 10000000
C15 126 0 9e-008
GI34 0 126 non_inv 81 1
C14 BVP0 0 1.5e-012
C13 BVP1 0 8e-013
C12 BVP2 0 2.4e-012
D53 non_inv 125 DIODE
V85 AVCCX 125 dc 2 ac 0 0
D52 124 non_inv DIODE
V84 124 AVEEX dc 2 ac 0 0
D51 81 123 DIODE
V83 AVCCX 123 dc 2 ac 0 0
D50 122 81 DIODE
V82 122 AVEEX dc 2 ac 0 0
R52 121 BVREFL 100
R51 121 BVREFH 50000
R50 BVP0 non_inv 100000
R49 BVN0 81 100000 
R48 BVP1 BVP0 100000
R47 BVN1 BVN0 100000
R46 BVP2 BVP1 100000
R45 BVN2 BVN1 100000
R44 BVP3 BVP2 100000
R43 BVN3 BVN2 100000
R42 non_inv 121 79900 
R41 81 106 80000
V81 VINT 88 dc 0.00015 ac 0 0
V80 87 0 dc 0 ac 0 0
R64 85 87 0.0166
xV79 0 85 88 115 IC_V_SourceV79
.SUBCKT IC_V_SourceV79 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
D49 VINT 117 DIODE
V78 AVCCX 117 dc 1.8 ac 0 0
D48 116 VINT DIODE
V77 116 AVEEX dc 1.5 ac 0 0
D37 100 119 DIODE
V47 VCLN 100 dc 0.6 ac 0 0
D36 119 99 DIODE
V46 99 VCLP dc 0.6 ac 0 0
EV45 VCTRL 0 119 0 1
C11 0 119 4.77465e-008
R40 0 119 3161177.66
GI32 0 119 115 VCTRL 1
R61 VREF2 VREF1 0
R59 VREF VREF2 0
V57 69 0 dc 0 ac 0 0
Rn 53 69 0.0166
xVn 0 53 77 VREF IC_V_SourceVn
.SUBCKT IC_V_SourceVn 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 100
.ends
V56 77 0 dc 2.5 ac 0 0
D18 51 OAVN DIODE
V17 51 AVEEX dc 1.5 ac 0 0
D17 OAVN 50 DIODE
V13 AVCCX 50 dc 1.8 ac 0 0
D16 49 OAVP DIODE
V12 49 AVEEX dc 1.5 ac 0 0
D15 OAVP 48 DIODE
V7 AVCCX 48 dc 1.8 ac 0 0
V59 80 0 dc 0 ac 0 0
R60 66 80 0.0166
xV58 0 66 78 25 IC_V_SourceV58
.SUBCKT IC_V_SourceV58 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
EV6 OAVO 0 33 0 1
C3 0 33 4.77465e-008
D14 33 37 DIODE
V2 AVCCX 37 dc 1.5 ac 0 0
D13 27 33 DIODE
V14 27 AVEEX dc 1.5 ac 0 0
R32 0 33 3161177.66
GI1 0 33 25 OAVN 1
IBN_OPAMP OAVN 0 dc 5e-009 ac 0 0
IBP_OPAMP OAVP 0 dc 5e-009 ac 0 0
VOSIN_OPAMP OAVP 78 dc 0.00015 ac 0 0
D59 CSH 59 DIODE
D58 60 CSH DIODE
D32 ISMEA 63 DIODE
D31 58 ISMEA DIODE
I25 CSH AVEEX dc 0.0002 ac 0 0
I24 56 AVEEX dc 0.0002 ac 0 0
D35 CSH 56 DIODE
Q11 AVCCX 56 CSH NPN
D34 AVEEX 54 DIODE
D33 54 AVCCX DIODE
V40 ISMEA 68 dc 0.00015 ac 0 0
V39 70 0 dc 0 ac 0 0
R37 67 70 0.0166 
xV38 0 67 68 47 IC_V_SourceV38
.SUBCKT IC_V_SourceV38 1 2 3 4
v1 2 1 dc 0
h1 4 3 v1 10
.ends
V37 AVCCX 63 dc 1.8 ac 0 0
V35 58 AVEEX dc 1.4 ac 0 0
EV34 56 0 54 0 1
C8 0 54 4.77465e-008
R36 0 54 3161177.66
GI23 0 54 47 CSH 1
R66 89 22 10000
D46 98 95 DIODE
D45 95 97 DIODE
V74 97 0 dc 7 ac 0 0
Q10 93 96 0 PNP
EV73 96 0 95 0 1
R69 104 95 1000
GI29 104 95 90 92 1
R67 DVCCX 93 1000
EV72 94 0 MODE 0 1
V71 91 0 dc 1.613 ac 0 0
R65 94 89 2400
EV70 22 0 93 0 1
EV69 92 0 91 0 1
EV68 90 0 89 0 1
xS3 CV_IN+ VSET VVP0 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xS2 CV_IN- VVE1 VVE0 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xS1 CC_IN- IVE1 IVE0 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xSISVN ISVN PGIA_IN- PGIA_IN+ 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
xS4 ISVP PGIA_IN+ PGIA_IN- 22 0 VC_SPDT__SWITCH__1 Params: Von=2 Voff=0.8 Ron=0.01 Roff=1000000
I22 OCPR 0 dc 2.5e-007 ac 0 0
I21 OCPS 0 dc 2.5e-007 ac 0 0
I20 OVPR 0 dc 2.5e-007 ac 0 0
I19 OVPS 0 dc 2.5e-007 ac 0 0
R29 74 72 10000
R28 65 74 10000
EV36 FAULT 0 73 0 1
R27 DVCCX 73 1000 
Q9 73 74 0 NPN
R26 DVCCX 72 1000
Q8 72 71 0 PNP
R25 0 71 10000000 
GI18 0 71 OCPS OCPR 1
D26 0 64 DIODE
D25 64 DVCCX DIODE
R14 DVCCX 65 1000
Q7 65 64 0 PNP
R13 0 64 10000000
GI17 0 64 OVPS OVPR 1


.model DIODE  D

.model PNP PNP

.MODEL NPN NPN

.MODEL NPN1 NPN
+ (
+  Level=1
+ )
 

.subckt VC_SPDT__SWITCH__1 inA outA1 outA2 ctrlp ctrln Params: Von=1 Voff=1 Ron=1 Roff=1
s1 inA outA1 ctrlp ctrln sw1
s2 inA outA2 ctrlp ctrln sw2

.model sw1 vswitch(Ron={Ron} Roff={Roff} Von={Von} Voff={Voff})
.model sw2 vswitch(Ron={Ron} Roff={Roff} Von={Voff} Voff={Von})

.ends


.ENDS AD8450
